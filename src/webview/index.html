<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BunNote</title>
    <script src="https://cdn.jsdelivr.net/npm/easymde@2.18.0/dist/easymde.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/easymde@2.18.0/dist/easymde.min.css">
    <link rel="stylesheet" type="text/css"
        href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/regular/style.css" />
    <link rel="stylesheet" type="text/css"
        href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/fill/style.css" />
    <style>
        body.loading .container {
            opacity: 0;
            pointer-events: none;
        }

        .loading_overlay {
            position: fixed;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--vscode-editor-background, #1e1e1e);
            color: var(--vscode-editor-foreground, #ffffff);
            z-index: 9999;
        }

        .loading_spinner {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.35);
            border-top-color: rgba(255, 255, 255, 0.85);
            animation: loadingSpin 0.8s linear infinite;
        }

        @keyframes loadingSpin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
    <link rel="stylesheet" href="{{CSS_URI}}">
    <link rel="stylesheet" href="{{EDITOR_CSS_URI}}">
</head>

<body class="loading" data-editor-mode="{{EDITOR_MODE}}" data-marker-color="{{MARKER_COLOR_MODE}}"
    data-locale="{{LOCALE}}"
    style="--bunnote-editor-font-size: {{EDITOR_FONT_SIZE}}px;">
    <script>
        // Initialize translations
        window.BUNNOTE_TRANSLATIONS = {{TRANSLATIONS}};
        window.BUNNOTE_LOCALE = "{{LOCALE}}";
        window.t = function(key, ...args) {
            let text = window.BUNNOTE_TRANSLATIONS[key] || key;
            args.forEach((arg, index) => {
                text = text.replace(`{${index}}`, arg);
            });
            return text;
        };
    </script>
    <div class="loading_overlay" id="appLoading" aria-label="Loading">
        <div class="loading_spinner" role="status" aria-live="polite"></div>
    </div>
    <div class="container">
        <div class="sidebar"></div>

        <div class="editor_area">
            <div class="editor_header">
                <div class="editor_title_wrapper">
                    <textarea class="editor_title_input" id="editorTitleInput" rows="1" autocomplete="off"
                        placeholder=""></textarea>
                </div>
            </div>
            <div class="editor_container">
                <textarea class="markdown_editor" id="editor"></textarea>
            </div>
            <div class="editor_stats" id="editorStats">
                <span class="editor_stats_item">
                    <span id="wordCount">0</span> <span id="wordsLabel"></span>
                </span>
                <span class="editor_stats_item">
                    <span id="charCount">0</span> <span id="charactersLabel"></span>
                </span>
            </div>
        </div>
    </div>

    <div class="context_menu" id="fileContextMenu" role="menu" aria-hidden="true">
        <button class="context_menu_item" id="openInEditorAction" role="menuitem" data-i18n="contextMenu.openInEditor">
            <i class="ph ph-arrow-square-out"></i>
            <span class="menu-text"></span>
        </button>
        <div class="context_menu_separator" role="separator"></div>
        <button class="context_menu_item" id="editTitleAction" role="menuitem" data-i18n="contextMenu.editTitle">
            <i class="ph ph-pencil-simple"></i>
            <span class="menu-text"></span>
        </button>
        <button class="context_menu_item" id="duplicateFileAction" role="menuitem" data-i18n="contextMenu.duplicateNote">
            <i class="ph ph-copy"></i>
            <span class="menu-text"></span>
        </button>
        <div class="context_menu_separator" role="separator"></div>
        <button class="context_menu_item destructive" id="deleteFileAction" role="menuitem" data-i18n="contextMenu.deleteNote">
            <i class="ph ph-trash"></i>
            <span class="menu-text"></span>
        </button>
    </div>

    <div class="context_menu" id="folderContextMenu" role="menu" aria-hidden="true">
        <button class="context_menu_item" id="createSubfolderAction" role="menuitem" data-i18n="contextMenu.newFolder">
            <i class="ph ph-folder-plus"></i>
            <span class="menu-text"></span>
        </button>
        <div class="context_menu_separator" role="separator"></div>
        <button class="context_menu_item" id="renameFolderAction" role="menuitem" data-i18n="contextMenu.renameFolder">
            <i class="ph ph-pencil-simple"></i>
            <span class="menu-text"></span>
        </button>
        <div class="context_menu_separator" role="separator"></div>
        <button class="context_menu_item destructive" id="deleteFolderAction" role="menuitem" data-i18n="contextMenu.deleteFolder">
            <i class="ph ph-trash"></i>
            <span class="menu-text"></span>
        </button>
    </div>

    <div class="context_menu" id="listContextMenu" role="menu" aria-hidden="true">
        <button class="context_menu_item" id="createFolderAction" role="menuitem" data-i18n="contextMenu.newFolder">
            <i class="ph ph-folder-plus"></i>
            <span class="menu-text"></span>
        </button>
    </div>

    <div class="context_menu" id="editorContextMenu" role="menu" aria-hidden="true">
        <button class="context_menu_item" id="editorBoldAction" role="menuitem" data-i18n="contextMenu.bold">
            <i class="ph ph-text-bolder"></i>
            <span class="menu-text"></span>
        </button>
        <button class="context_menu_item" id="editorItalicAction" role="menuitem" data-i18n="contextMenu.italic">
            <i class="ph ph-text-italic"></i>
            <span class="menu-text"></span>
        </button>
        <button class="context_menu_item" id="editorStrikeAction" role="menuitem" data-i18n="contextMenu.strikethrough">
            <i class="ph ph-text-strikethrough"></i>
            <span class="menu-text"></span>
        </button>
        <div class="context_menu_separator" role="separator"></div>
        <button class="context_menu_item" id="editorBulletListAction" role="menuitem" data-i18n="contextMenu.bulletList">
            <i class="ph ph-list-bullets"></i>
            <span class="menu-text"></span>
        </button>
        <button class="context_menu_item" id="editorNumberListAction" role="menuitem" data-i18n="contextMenu.numberList">
            <i class="ph ph-list-numbers"></i>
            <span class="menu-text"></span>
        </button>
        <button class="context_menu_item" id="editorTaskListAction" role="menuitem" data-i18n="contextMenu.taskList">
            <i class="ph ph-check-square"></i>
            <span class="menu-text"></span>
        </button>
        <div class="context_menu_separator" role="separator"></div>
        <button class="context_menu_item" id="editorQuoteAction" role="menuitem" data-i18n="contextMenu.blockquote">
            <i class="ph ph-quotes"></i>
            <span class="menu-text"></span>
        </button>
        <button class="context_menu_item" id="editorCodeBlockAction" role="menuitem" data-i18n="contextMenu.codeBlock">
            <i class="ph ph-code-block"></i>
            <span class="menu-text"></span>
        </button>
        <button class="context_menu_item" id="editorInlineCodeAction" role="menuitem" data-i18n="contextMenu.inlineCode">
            <i class="ph ph-code"></i>
            <span class="menu-text"></span>
        </button>
    </div>

    <script src="{{UTILS_URI}}"></script>
    <script src="{{FILE_MANAGER_URI}}"></script>
    <script src="{{EDITOR_URI}}"></script>
    <script src="{{EVENTS_URI}}"></script>
    <script src="{{MAIN_URI}}"></script>
    <script>
        // Apply translations to UI elements
        document.addEventListener('DOMContentLoaded', function() {
            // Translate context menu items
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                const textSpan = el.querySelector('.menu-text');
                if (textSpan) {
                    textSpan.textContent = window.t(key);
                }
            });
            
            // Translate editor placeholders
            const titleInput = document.getElementById('editorTitleInput');
            if (titleInput) {
                titleInput.placeholder = window.t('editor.untitled');
            }
            
            // Translate stats labels
            const wordsLabel = document.getElementById('wordsLabel');
            const charactersLabel = document.getElementById('charactersLabel');
            if (wordsLabel) wordsLabel.textContent = window.t('editor.words');
            if (charactersLabel) charactersLabel.textContent = window.t('editor.characters');
        });
    </script>
</body>

</html>